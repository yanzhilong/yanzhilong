<?xml version="1.0" encoding="utf-8" ?>
<sqlMap namespace="TbPropertyMapping" xmlns="http://ibatis.apache.org/mapping"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" >

  <alias>
    <typeAlias alias="TbPropertyMapping" type="yanzhilong.Domain.TbPropertyMapping,yanzhilong" />   
  </alias>

  <resultMaps>
    <resultMap id="SelectAllResult" class="TbPropertyMapping">
       <result property="Id" column="Id" dbType="VARCHAR" type="string" />
       <result property="tbProperty" resultMapping="TbProperty.SelectAllResultExtend" />
       <result property="tbPropertyCategory" resultMapping="TbPropertyCategory.SelectAllResultExtend" />
    </resultMap>
  </resultMaps>
  
  <statements>
    <select id="SelectAllTbPropertyMappings" resultMap="SelectAllResult">
      <![CDATA[  
      SELECT 
      PM.Id,
      PM.TbPropertyId,
      PM.TbPropertyCategoryId,
      P.Name TbPropertyName,
      P.ValueKey TbPropertyValueKey,
      PC.Name TbPropertyCategoryName,
      PC.ValueKey TbPropertyCategoryValueKey
      FROM tb_propertymapping PM inner join tb_property P on PM.TbPropertyId = P.Id inner join tb_propertycategory PC on PM.TbPropertyCategoryId = PC.Id
      ]]>
    </select>
    
    <select id="SelectTbPropertyMappingByCondition" parameterClass="TbPropertyMapping" resultMap="SelectAllResult" extends="SelectAllTbPropertyMappings">
      <dynamic prepend="WHERE">
      
       <isNotEmpty prepend="AND" property="Id">
          <![CDATA[  
           Id = #Id#
            ]]>
        </isNotEmpty>
        
       <isNotEmpty prepend="AND" property="tbProperty.Id">
          <![CDATA[  
           PM.TbPropertyId = #tbProperty.Id#
            ]]>
        </isNotEmpty>
        
       <isNotEmpty prepend="AND" property="tbPropertyCategory.Id">
          <![CDATA[  
           PM.TbPropertyCategoryId = #tbPropertyCategory.Id#
            ]]>
        </isNotEmpty>
        
      </dynamic>
    </select>
    
    <insert id="InsertTbPropertyMapping" parameterClass="TbPropertyMapping">
      <![CDATA[ 
      INSERT INTO tb_propertymapping
      (
      Id,
      TbPropertyId,
      TbPropertyCategoryId
      )
      VALUES
      (
      #Id#,
      #tbProperty.Id#,
      #tbPropertyCategory.Id#
      )
      ]]>
    </insert>
    
    <update id="UpdateTbPropertyMapping" parameterClass="TbPropertyMapping">
      <![CDATA[           
      UPDATE tb_propertymapping SET   
      Id=#Id#,
      TbPropertyId=#tbProperty.Id#,
      TbPropertyCategoryId=#tbPropertyCategory.Id#
      WHERE Id = #Id#
      ]]>
    </update>
   
    <delete id="DeleteTbPropertyMapping" parameterClass="TbPropertyMapping">
      <![CDATA[
      Delete From tb_propertymapping Where Id = #Id#
      ]]>
    </delete>

  </statements>
</sqlMap>
